library(readxl)
library(tidyverse)

planilhas <- readxl::excel_sheets('Projeto Caminho da Prosperidade.xlsx')
eixos <- planilhas[!(planilhas %in% c('Controle', 'Promessas', 'Investimento'))]

data_raw <- list()

for (eixo in eixos) {
  
  df <- read_excel('Projeto Caminho da Prosperidade.xlsx', sheet = eixo)
  df$eixo <- eixo
  
  data_raw[[eixo]] <- df
  
}

data_pre <- bind_rows(data_raw)

data <- data_pre %>%
  tidyr::fill(Tema) %>%
  filter(!is.na(`Ação`)) %>%
  mutate(Tema = replace(Tema, 'ESTADOS E MUNICÍPIOS', ''))

eixo_tema <- data %>%
  select(eixo, Tema) %>%
  distinct()

contagem <- eixo_tema %>% count(Tema)
